{"componentChunkName":"component---src-templates-post-template-tsx","path":"/posts/bivariance-in-react1","result":{"data":{"site":{"siteMetadata":{"title":"June"}},"markdownRemark":{"id":"e5183fef-8a4b-5ed5-b468-b261d1267c8b","excerpt":"react의 ref 객체를 업데이트 의존성으로 넣어줘야 할 때 포스트에서 일반 함수를 useCallback으로 감싸지 않으면 re-render마다 업데이트 됩니다. 여기서 RefCallback은 일반 함수와 동일하다고 생각해주세요. 주석과 bivarianceHack…","html":"<p><a href=\"https://jicjjang.github.io/posts/react-useref\" target=\"_blank\" rel=\"noopener\">react의 ref 객체를 업데이트 의존성으로 넣어줘야 할 때</a> 포스트에서</p>\n<p><strong><em>일반 함수를 useCallback으로 감싸지 않으면 re-render마다 업데이트 됩니다. 여기서 RefCallback은 일반 함수와 동일하다고 생각해주세요. 주석과 bivarianceHack 에 대해선 다음 포스트로 엮어보겠습니다.</em></strong></p>\n<p>라는 글을 남겼었는데, 이번 포스트를 통해 <code class=\"language-text\">bivarianceHack</code>이 뭔지에 대해 한번 자세히 알아보...기 전에!\n타입스크립트를 사용한다면 <code class=\"language-text\">bivariance</code> 라는 용어가 종종 등장하는데, 대체 뭐길래 react에서도, 타입스크립트에서도\n자꾸 등장하는지 짚어보고 가겠습니다.</p>\n<h2 id=\"공변성-반공변성-이변성\" style=\"position:relative;\">공변성, 반공변성, 이변성<a href=\"#%EA%B3%B5%EB%B3%80%EC%84%B1-%EB%B0%98%EA%B3%B5%EB%B3%80%EC%84%B1-%EC%9D%B4%EB%B3%80%EC%84%B1\" aria-label=\"공변성 반공변성 이변성 permalink\" class=\"autolink-headers-- after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>우선 이변성을 알기 위해 함께 알아야 할 공변성, 반공변성을 포함해 함께 뜻을 알아봅시다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 480px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/846cc2ee18b9b946326610e5b8122786/2b08c/words_wiki.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.499999999999996%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB2rCgf//EABQQAQAAAAAAAAAAAAAAAAAAABD/2gAIAQEAAQUCf//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAABD/2gAIAQEABj8Cf//EABkQAAIDAQAAAAAAAAAAAAAAAAABESExYf/aAAgBAQABPyG40SrWR0//2gAMAwEAAgADAAAAEPAP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGBABAQEBAQAAAAAAAAAAAAAAAQARQVH/2gAIAQEAAT8QMgOZUNa9X//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"words_wiki\"\n        title=\"words_wiki\"\n        src=\"/static/846cc2ee18b9b946326610e5b8122786/7cc5e/words_wiki.jpg\"\n        srcset=\"/static/846cc2ee18b9b946326610e5b8122786/e439a/words_wiki.jpg 120w,\n/static/846cc2ee18b9b946326610e5b8122786/09b79/words_wiki.jpg 240w,\n/static/846cc2ee18b9b946326610e5b8122786/7cc5e/words_wiki.jpg 480w,\n/static/846cc2ee18b9b946326610e5b8122786/80e3c/words_wiki.jpg 720w,\n/static/846cc2ee18b9b946326610e5b8122786/6a068/words_wiki.jpg 960w,\n/static/846cc2ee18b9b946326610e5b8122786/2b08c/words_wiki.jpg 2974w\"\n        sizes=\"(max-width: 480px) 100vw, 480px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><a href=\"https://ko.wikipedia.org/wiki/%EA%B3%B5%EB%B3%80%EC%84%B1%EA%B3%BC_%EB%B0%98%EA%B3%B5%EB%B3%80%EC%84%B1_(%EC%BB%B4%ED%93%A8%ED%84%B0_%EA%B3%BC%ED%95%99)\" target=\"_blank\" rel=\"noopener\">위키백과</a>의 내용을 저희가 확인한 주석이 있었던 definition file, 즉 typescript 관점에서 살펴보겠습니다.</p>\n<ul>\n<li>우선 subtype과 supertype에 대해 알고 가야 합니다. <code class=\"language-text\">A</code>, <code class=\"language-text\">B</code> 라는 타입이 있을 때 <code class=\"language-text\">A</code>타입이 <code class=\"language-text\">B</code>타입을 포함한다면 <code class=\"language-text\">A</code>타입을 supertype, <code class=\"language-text\">B</code>타입을 subtype이라고 합니다.</li>\n<li>공변성은 supertype, subtype 관계인 <code class=\"language-text\">A</code>, <code class=\"language-text\">B</code> (<code class=\"language-text\">A-&gt;B</code>)는 <code class=\"language-text\">T&lt;A&gt;</code>, <code class=\"language-text\">T&lt;B&gt;</code> 형식에서도 supertype, subtype 관계를 유지한다(<code class=\"language-text\">T&lt;A&gt; -&gt; T&lt;B&gt;</code>)는 의미입니다.</li>\n<li>반공변성은 supertype, subtype 관계인 <code class=\"language-text\">A</code>, <code class=\"language-text\">B</code> (<code class=\"language-text\">A-&gt;B</code>)는 <code class=\"language-text\">T&lt;A&gt;</code>, <code class=\"language-text\">T&lt;B&gt;</code> 형식에서는 supertype, subtype 관계가 역전된다(<code class=\"language-text\">T&lt;B&gt; -&gt; T&lt;A&gt;</code>)는 의미입니다.</li>\n<li>이변성은 공변성, 반공변성의 성질을 모두 가집니다. supertype, subtype 관계인 <code class=\"language-text\">A</code>, <code class=\"language-text\">B</code> (<code class=\"language-text\">A-&gt;B</code>)는 <code class=\"language-text\">T&lt;A&gt;</code>, <code class=\"language-text\">T&lt;B&gt;</code> 형식에서는 서로 supertype, subtype 관계를 가집니다. (<code class=\"language-text\">T&lt;A&gt; -&gt; T&lt;B&gt;, T&lt;B&gt; -&gt; T&lt;A&gt;</code>)</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">type</span> <span class=\"token class-name\">Variance<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>a<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span>\n\n<span class=\"token keyword\">let</span> a<span class=\"token operator\">:</span> Variance<span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> <span class=\"token builtin\">number</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">let</span> b<span class=\"token operator\">:</span> Variance<span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 공변성</span>\na <span class=\"token operator\">=</span> b<span class=\"token punctuation\">;</span> <span class=\"token comment\">// OK</span>\nb <span class=\"token operator\">=</span> a<span class=\"token punctuation\">;</span> <span class=\"token comment\">// Error</span>\n\n<span class=\"token comment\">// 반공변성</span>\na <span class=\"token operator\">=</span> b<span class=\"token punctuation\">;</span> <span class=\"token comment\">// Error</span>\nb <span class=\"token operator\">=</span> a<span class=\"token punctuation\">;</span> <span class=\"token comment\">// OK</span>\n\n<span class=\"token comment\">// 이변성</span>\na <span class=\"token operator\">=</span> b<span class=\"token punctuation\">;</span> <span class=\"token comment\">// OK</span>\nb <span class=\"token operator\">=</span> a<span class=\"token punctuation\">;</span> <span class=\"token comment\">// OK</span></code></pre></div>\n<h2 id=\"typescript에서의-공변성-반공변성-이변성\" style=\"position:relative;\">typescript에서의 공변성, 반공변성, 이변성<a href=\"#typescript%EC%97%90%EC%84%9C%EC%9D%98-%EA%B3%B5%EB%B3%80%EC%84%B1-%EB%B0%98%EA%B3%B5%EB%B3%80%EC%84%B1-%EC%9D%B4%EB%B3%80%EC%84%B1\" aria-label=\"typescript에서의 공변성 반공변성 이변성 permalink\" class=\"autolink-headers-- after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>typescript는 기본적으로 값은 공변성을, 함수는 이변성을 유지합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">let</span> convariance1<span class=\"token operator\">:</span> <span class=\"token builtin\">Array</span><span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> <span class=\"token builtin\">number</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'2'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'3'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> convariance2<span class=\"token operator\">:</span> <span class=\"token builtin\">Array</span><span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'2'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'3'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\nconvariance1 <span class=\"token operator\">=</span> convariance2<span class=\"token punctuation\">;</span> <span class=\"token comment\">// OK</span>\nconvariance2 <span class=\"token operator\">=</span> convariance1<span class=\"token punctuation\">;</span> <span class=\"token comment\">// Error</span>\n\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">Variance<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>a<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span>\n\n<span class=\"token keyword\">let</span> a<span class=\"token operator\">:</span> Variance<span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> <span class=\"token builtin\">number</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">let</span> b<span class=\"token operator\">:</span> Variance<span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\na <span class=\"token operator\">=</span> b<span class=\"token punctuation\">;</span> <span class=\"token comment\">// OK</span>\nb <span class=\"token operator\">=</span> a<span class=\"token punctuation\">;</span> <span class=\"token comment\">// OK</span></code></pre></div>\n<p>왜 이런 특성을 갖는지 알아보기 전에, 한번 고민해봅시다.\n변수는 <code class=\"language-text\">Array&lt;string | number&gt;</code>타입 안에 <code class=\"language-text\">Array&lt;string&gt;</code>타입 값이 들어가는게(공변성) 맞을까요?\n아니면 반대(반공변성)가 맞을까요?</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">let</span> convariance1<span class=\"token operator\">:</span> <span class=\"token builtin\">Array</span><span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'1'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 맞다면 반공변성</span>\n<span class=\"token keyword\">let</span> convariance1<span class=\"token operator\">:</span> <span class=\"token builtin\">Array</span><span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> <span class=\"token builtin\">number</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'2'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'3'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 맞다면 공변성</span></code></pre></div>\n<p>값을 직접 넣어 비교해보자면 무조건 공변성이 맞을것 같습니다. 함수도 한번 살펴볼까요?</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">type</span> <span class=\"token class-name\">Variance<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>a<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span>\n\n<span class=\"token keyword\">let</span> a<span class=\"token operator\">:</span> Variance<span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> <span class=\"token builtin\">number</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">let</span> b<span class=\"token operator\">:</span> Variance<span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// a = b가 맞다면, a의 타입이 string | number 이므로, number 타입이 값이 들어와도 통과되어야 함</span>\n<span class=\"token comment\">// 약간... 다운캐스팅의 느낌?</span>\na <span class=\"token operator\">=</span> b<span class=\"token punctuation\">;</span>\n<span class=\"token function\">a</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// b는 애초에 string 타입만 됨.</span>\n<span class=\"token comment\">// 약간... 업캐스팅의 느낌?</span>\nb <span class=\"token operator\">=</span> a<span class=\"token punctuation\">;</span>\n<span class=\"token function\">b</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"1\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>이런 차이에 대해 생각해봤을 때 똑같은건 아니지만 OOP에 대해 배웠다면 알고있을 <code class=\"language-text\">업캐스팅 &amp; 다운캐스팅</code>이 생각나더라구요.\n타입스크립트에선 타입이지만, <code class=\"language-text\">업캐스팅 &amp; 다운캐스팅</code>에선 메서드가 더 있는지 없는지의 차이가 있는거죠.</p>\n<p><strong><em>글을 작성하면서 검색해봤더니 업캐스팅 &#x26; 다운캐스팅이 공변성, 반공변성 특성을 가지고 있는게 맞았네요.</em></strong>\n<strong><em>다른 언어에서는 공변성, 반공변성을 컨트롤 할 수 있는 방법이 코드 레벨로 있다고 합니다.</em></strong></p>\n<p>함수에선 기본적으로 반공변성이 맞습니다.\n일부러 타입 지정을 위해 타입스크립트를 사용하는데 왜 반공변성이 아닌 이변성을 기본적으로 지정해놨을까요?\n설명해보자면 <code class=\"language-text\">string | number</code>타입이 <code class=\"language-text\">string</code>타입을 포함하는게 자명합니다.\n그런데 함수가 된다면 <code class=\"language-text\">Variance&lt;string&gt;</code>타입 파라미터를 받는 함수에\n<code class=\"language-text\">Variance&lt;string | number&gt;</code>타입의 함수<code class=\"language-text\">만</code> 할당 가능하다는게 모호해지는 것이죠.</p>\n<p>그래서 유저가 자유롭게 컨트롤 할 수 있도록 설정과 꼼수와 같은 방법들이 만들어놨습니다.</p>\n<ol>\n<li><code class=\"language-text\">strictFunctionTypes</code></li>\n</ol>\n<p>기본적으로 유지하는 공변성에 반하는 특성을 가진 함수형태만 가능하다는게 조금 아쉽지만\n타입스크립트 tsconfig 옵션중에 <code class=\"language-text\">strictFunctionTypes</code> 옵션이 있습니다.</p>\n<p>위에 공변성 함수 형태와 일반적인 변수 형태 모두 보여드렸는데,\n옵션에 있는 이름 그대로 함수 타입의 공변성을 반공변성으로 바꿔주는 역할을 해줍니다.</p>\n<p>함수에만 해당되기 때문에 변수는 그대로 출력되게 됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token comment\">// 변수 형태</span>\n<span class=\"token keyword\">let</span> convariance1<span class=\"token operator\">:</span> <span class=\"token builtin\">Array</span><span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> <span class=\"token builtin\">number</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'2'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'3'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> convariance2<span class=\"token operator\">:</span> <span class=\"token builtin\">Array</span><span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'2'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'3'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\nconvariance1 <span class=\"token operator\">=</span> convariance2<span class=\"token punctuation\">;</span> <span class=\"token comment\">// OK</span>\nconvariance2 <span class=\"token operator\">=</span> convariance1<span class=\"token punctuation\">;</span> <span class=\"token comment\">// Error</span>\n\n<span class=\"token comment\">// 함수 형태</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">Variance<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>a<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span>\n\n<span class=\"token keyword\">let</span> a<span class=\"token operator\">:</span> Variance<span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> <span class=\"token builtin\">number</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">let</span> b<span class=\"token operator\">:</span> Variance<span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\na <span class=\"token operator\">=</span> b<span class=\"token punctuation\">;</span> <span class=\"token comment\">// Error</span>\nb <span class=\"token operator\">=</span> a<span class=\"token punctuation\">;</span> <span class=\"token comment\">// OK</span></code></pre></div>\n<ol start=\"2\">\n<li>클래스 구조로 코드 만들기</li>\n</ol>\n<p><a href=\"https://www.typescriptlang.org/ko/tsconfig#strictFunctionTypes\" target=\"_blank\" rel=\"noopener\">공식 문서</a>를 보시면 아시겠지만\n<code class=\"language-text\">strictFunctionTypes</code> 설정을 만드는 도중 클래스에서 안전하지 않은 부분을 발견했기 때문에, 함수레벨만 고려해서 만들었다고 합니다.\n따라서 <code class=\"language-text\">strictFunctionTypes</code> 설정이 되어있더라도 클래스 구조라면 이변성의 특징 그대로 사용이 가능합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">type</span> <span class=\"token class-name\">Methodish</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">func</span><span class=\"token punctuation\">(</span>x<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">fn</span><span class=\"token punctuation\">(</span>x<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Hello, \"</span> <span class=\"token operator\">+</span> x<span class=\"token punctuation\">.</span><span class=\"token function\">toLowerCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Ultimately an unsafe assignment, but not detected</span>\n<span class=\"token keyword\">const</span> m<span class=\"token operator\">:</span> Methodish <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  func<span class=\"token operator\">:</span> fn<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\nm<span class=\"token punctuation\">.</span><span class=\"token function\">func</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// OK</span></code></pre></div>\n<ol start=\"3\">\n<li>일반 인터페이스로 사용하기</li>\n</ol>\n<p><a href=\"https://github.com/microsoft/TypeScript/pull/18654\" target=\"_blank\" rel=\"noopener\">strictFunctionTypes 설정을 추가한 PR</a>을 보면 인터페이스에서 가능한 케이스도 정리되어있습니다.</p>\n<blockquote>\n<p>왜 docs에는 안써놓은거죠...?\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 480px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/78e9ad47bc86c4edc429d28838aabdeb/b99c8/except-interface-description1.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAHABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB2aBoJ//EABgQAQADAQAAAAAAAAAAAAAAAAABERIh/9oACAEBAAEFAuQ0t//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAABD/2gAIAQEABj8Cf//EABgQAAMBAQAAAAAAAAAAAAAAAAABESFh/9oACAEBAAE/IbiyOipH/9oADAMBAAIAAwAAABCL3//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAEDAQE/EIj/xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPxCn/8QAGRABAAIDAAAAAAAAAAAAAAAAAQARQVGx/9oACAEBAAE/EFiVo7XsCxB3Ak//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"except-interface-description1\"\n        title=\"except-interface-description1\"\n        src=\"/static/78e9ad47bc86c4edc429d28838aabdeb/7cc5e/except-interface-description1.jpg\"\n        srcset=\"/static/78e9ad47bc86c4edc429d28838aabdeb/e439a/except-interface-description1.jpg 120w,\n/static/78e9ad47bc86c4edc429d28838aabdeb/09b79/except-interface-description1.jpg 240w,\n/static/78e9ad47bc86c4edc429d28838aabdeb/7cc5e/except-interface-description1.jpg 480w,\n/static/78e9ad47bc86c4edc429d28838aabdeb/80e3c/except-interface-description1.jpg 720w,\n/static/78e9ad47bc86c4edc429d28838aabdeb/6a068/except-interface-description1.jpg 960w,\n/static/78e9ad47bc86c4edc429d28838aabdeb/b99c8/except-interface-description1.jpg 1612w\"\n        sizes=\"(max-width: 480px) 100vw, 480px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 480px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c701dcd6477d2b07ca14b5541ca50baf/b260b/except-interface-description2.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAQABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe3U0aD/xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAEFAl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAZEAACAwEAAAAAAAAAAAAAAAAAARARcSH/2gAIAQEAAT8hWHIWFKP/2gAMAwEAAgADAAAAEMMP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhABAQADAQEAAAAAAAAAAAAAAQARITFBUf/aAAgBAQABPxBebwfBHNBDLxiBeEODV//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"except-interface-description2\"\n        title=\"except-interface-description2\"\n        src=\"/static/c701dcd6477d2b07ca14b5541ca50baf/7cc5e/except-interface-description2.jpg\"\n        srcset=\"/static/c701dcd6477d2b07ca14b5541ca50baf/e439a/except-interface-description2.jpg 120w,\n/static/c701dcd6477d2b07ca14b5541ca50baf/09b79/except-interface-description2.jpg 240w,\n/static/c701dcd6477d2b07ca14b5541ca50baf/7cc5e/except-interface-description2.jpg 480w,\n/static/c701dcd6477d2b07ca14b5541ca50baf/80e3c/except-interface-description2.jpg 720w,\n/static/c701dcd6477d2b07ca14b5541ca50baf/6a068/except-interface-description2.jpg 960w,\n/static/c701dcd6477d2b07ca14b5541ca50baf/b260b/except-interface-description2.jpg 1658w\"\n        sizes=\"(max-width: 480px) 100vw, 480px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n</blockquote>\n<p>결론적으로 이 둘의 차이는 method 타입에서는 이변성을, function 타입에서는 반변성을 줍니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\"><span class=\"token constant\">IB</span></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// method type parameter position</span>\n  <span class=\"token function\">b</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\"><span class=\"token constant\">IA</span></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// function type parameter position</span>\n  <span class=\"token function-variable function\">a</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이는 공변성, 반공변성을 코드 레벨로 컨트롤하는 타 언어와는 다르지만,\n필요할 때 아예 사용하지 못하게 막을 순 없으니 편법으로 남겨둔 것이라 여겨집니다.</p>\n<hr>\n<p>이렇게 공변성, 반공변성, 이변성에 대해 알아봤습니다.\n다음 포스트로 react에서의 이변성 hack이 무엇인지 알아보겠습니다.</p>","frontmatter":{"title":"bivariance(이변성) in react1","date":"February 02, 2023","tags":["react","bivariance","covariance","contravariance"]}}},"pageContext":{"slug":"/posts/bivariance-in-react1","previous":{"fields":{"slug":"/posts/bivariance-in-react1 copy"},"frontmatter":{"title":"bivariance(이변성) in react1"}},"next":null}},"staticQueryHashes":["1576648375","1963346411"]}